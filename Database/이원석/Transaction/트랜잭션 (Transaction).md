# 트랜잭션 (Transaction)

---

`Database` 의 트랜잭션이란?

> `Database` 의 상태를 변화시키기 위해 수행하는 작업 단위
> 

상태를 변화시킨다 → SQL 질의어를 통해 DB에 접근하는 것

```sql
SELECT, INSERT, DELETE, UPDATE
```

작업 단위 → 많은 SQL 명령문들을 사람이 정하는 기준에 따라 정하는 것

```sql
Ex) 사용자 A가 사용자 B에게 1만원을 송금한다.

1. 사용자 A의 계좌에서 만원을 차감한다: UPDATE A 잔고
2. 사용자 B의 계좌에서 만원을 추가한다: UPDATE B 잔고

작업 단위: 출금 UPDATE + 입금 UPDATE
→ 이를 통틀어 하나의 트랜잭션이라고 한다.

- 위 두 쿼리문 모두 성공적으로 완료되어야만 하나의 작업(트랜잭션)이 완료되는 것 이다. (commit)
- 작업 단위에 속하는 쿼리중 하나라도 실패한다면 모든 쿼리문을 취소하고 이전 상태로 돌려놓는다. (Rollback)
```

즉, 하나의 트랜잭션 설계를 잘 만드는 것이 데이터를 다룰 때 많은 이점을 가져다준다고 한다.

### 트랜잭션의 특징

---

- 원자성 (`Atomicity`)
트랜잭션이 DB에 모두 반영되거나, 혹은 전혀 반영되지 않아야 한다.
- 일관성 (`Consistency`)
트랜잭션의 작업 처리 결과는 항상 일관성 있어야 한다.
- 독립성 (`Isolation`)
둘 이상의 트랜잭션이 동시에 병행 실행되고 있을 때, 어떤 트랜잭션도 다른 트랜잭션 연산에 끼어들 수 없다.
- 지속성 (`Durability`)
트랜잭션이 성공적으로 완료되었으면, 결과는 영구적으로 반영되어야 한다.

### Commit

하나의 트랜잭션이 성공적으로 끝났고, DB가 일관성있는 상태일 때 이를 알려주기 위해 사용하는 연산

### Rollback

하나의 트랜잭션 처리가 비정상적으로 종료되어 트랜잭션 원자성이 깨진 경우

transaction이 정상적으로 종료되지 않았을 때, last consistent state (예) Transaction의 시작 상태) 로 roll back 할 수 있음.